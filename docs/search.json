[
  {
    "objectID": "daily_27-28.html",
    "href": "daily_27-28.html",
    "title": "Daily Assignments 27&28",
    "section": "",
    "text": "Define River Object\n\nlibrary(osmdata)\n\nData (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright\n\nlibrary(sf)\n\nLinking to GEOS 3.13.1, GDAL 3.10.2, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(terra)\n\nterra 1.8.42\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nbbox &lt;- getbb(\"Fort Collins, Colorado\")\n\nfc_osm &lt;- opq(bbox = bbox) %&gt;%\n  add_osm_feature(key = \"waterway\") %&gt;%\n  osmdata_sf()\n\npoudre_river &lt;- fc_osm$osm_lines %&gt;%\n  filter(grepl(\"Cache la Poudre\", name, ignore.case = TRUE))\n\npoudre_river_union &lt;- st_union(poudre_river)\n\npoudre_river_sf &lt;- st_as_sf(poudre_river_union)\n\nriver_length &lt;- st_length(poudre_river_sf)\nprint(river_length)\n\n218184.6 [m]\n\n\n\npoudre_river_union &lt;- st_union(poudre_river)\n\npoudre_river_line &lt;- st_cast(poudre_river_union, \"MULTILINESTRING\")\n\npoudre_pts &lt;- st_cast(poudre_river_line, \"POINT\")\n\nlength(poudre_pts)\n\n[1] 5209\n\n\n\n\nDefine DEM Object\n\ndem &lt;- rast(\"https://raw.githubusercontent.com/mikejohnson51/csu-ess-330/refs/heads/main/resources/foco-elev-cm.tif\")\n\nplot(dem)\n\n\n\n\n\n\n\n\n\n\nExtract River Profile\n\npoudre_pts &lt;- st_cast(poudre_river, \"POINT\")\n\nWarning in st_cast.sf(poudre_river, \"POINT\"): repeating attributes for all\nsub-geometries for which they may not be constant\n\npoudre_pts &lt;- st_transform(poudre_pts, crs(dem))\n\n\npoudre_vect &lt;- vect(poudre_pts)\nelevation_df &lt;- extract(dem, poudre_vect)\n\n\npoudre_pts$elevation &lt;- elevation_df[, 2][[1]]\n\n\npoudre_pts &lt;- poudre_pts %&gt;%\n  mutate(ID = row_number())\n\nclass(poudre_pts)          \n\n[1] \"sf\"         \"data.frame\"\n\nst_geometry(poudre_pts)   \n\nGeometry set for 5252 features \nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -823445.8 ymin: 1966756 xmax: -722478 ymax: 2008678\nProjected CRS: unnamed\nFirst 5 geometries:\n\n\nPOINT (-798489 2005477)\n\n\nPOINT (-798477.4 2005502)\n\n\nPOINT (-798452.7 2005523)\n\n\nPOINT (-798422.1 2005531)\n\n\nPOINT (-798384 2005532)\n\nhead(poudre_pts)           \n\nSimple feature collection with 6 features and 29 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -798489 ymin: 2005477 xmax: -798344.1 ymax: 2005532\nProjected CRS: unnamed\n             osm_id                  name alt_name area boat bridge  ele\n47471985   47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n47471985.1 47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n47471985.2 47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n47471985.3 47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n47471985.4 47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n47471985.5 47471985 Cache la Poudre River     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n           gnis:feature_id intermittent irrigation layer level note\n47471985              &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n47471985.1            &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n47471985.2            &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n47471985.3            &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n47471985.4            &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n47471985.5            &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;\n           official_name oneway ref:US:NID seamark:type service source\n47471985            &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n47471985.1          &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n47471985.2          &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n47471985.3          &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n47471985.4          &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n47471985.5          &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;\n           source:geometry stream surface tunnel waterway width wikidata\n47471985              &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n47471985.1            &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n47471985.2            &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n47471985.3            &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n47471985.4            &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n47471985.5            &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;    river  &lt;NA&gt;     &lt;NA&gt;\n                          wikipedia                  geometry elevation ID\n47471985   en:Cache la Poudre River   POINT (-798489 2005477)        NA  1\n47471985.1 en:Cache la Poudre River POINT (-798477.4 2005502)        NA  2\n47471985.2 en:Cache la Poudre River POINT (-798452.7 2005523)        NA  3\n47471985.3 en:Cache la Poudre River POINT (-798422.1 2005531)        NA  4\n47471985.4 en:Cache la Poudre River   POINT (-798384 2005532)        NA  5\n47471985.5 en:Cache la Poudre River POINT (-798344.1 2005525)        NA  6\n\n\n\n\nCompute Sinuosity\n\n# Check the coordinates of the first and last points to confirm they're correct\nstart_pt_coords &lt;- st_coordinates(poudre_pts[1, ])\nend_pt_coords &lt;- st_coordinates(poudre_pts[nrow(poudre_pts), ])\n\nprint(start_pt_coords)\n\n           X       Y\n[1,] -798489 2005477\n\nprint(end_pt_coords)\n\n             X       Y\n[1,] -752994.3 1986086\n\n# Compute the straight-line distance between the first and last points\nstraight_dist &lt;- st_distance(poudre_pts[1, ], poudre_pts[nrow(poudre_pts), ])\nstraight_dist_m &lt;- as.numeric(straight_dist)\n\n# Get the total river length (already calculated)\nriver_length_m &lt;- as.numeric(st_length(poudre_river))\n\n# Calculate sinuosity\nsinuosity &lt;- river_length_m / straight_dist_m\nprint(paste(\"Sinuosity:\", sinuosity))\n\n [1] \"Sinuosity: 0.656965999091874\"    \"Sinuosity: 0.212834884817007\"   \n [3] \"Sinuosity: 0.000303938917985101\" \"Sinuosity: 0.385691650702556\"   \n [5] \"Sinuosity: 0.00172975553993978\"  \"Sinuosity: 0.0355373738052208\"  \n [7] \"Sinuosity: 0.000811607367088229\" \"Sinuosity: 0.00710726021518992\" \n [9] \"Sinuosity: 0.00175601578574925\"  \"Sinuosity: 0.000348311827356954\"\n[11] \"Sinuosity: 0.00957199978947784\"  \"Sinuosity: 0.0154358657180877\"  \n[13] \"Sinuosity: 0.012056106416191\"    \"Sinuosity: 0.00689745601020177\" \n[15] \"Sinuosity: 0.00208604904001204\"  \"Sinuosity: 0.000813980772403408\"\n[17] \"Sinuosity: 0.0181507066189815\"   \"Sinuosity: 0.00220526916351366\" \n[19] \"Sinuosity: 0.134022826554769\"    \"Sinuosity: 0.000530017078253025\"\n[21] \"Sinuosity: 0.810685958100599\"    \"Sinuosity: 0.0241517807018409\"  \n[23] \"Sinuosity: 0.0153727515323692\"   \"Sinuosity: 0.0148187204096931\"  \n[25] \"Sinuosity: 0.000488615518879972\" \"Sinuosity: 0.000503483176869332\"\n[27] \"Sinuosity: 0.00235983859785013\"  \"Sinuosity: 0.312496811853476\"   \n[29] \"Sinuosity: 0.495445256068716\"    \"Sinuosity: 0.000341890017100514\"\n[31] \"Sinuosity: 0.207566839285649\"    \"Sinuosity: 0.67943864731065\"    \n[33] \"Sinuosity: 0.0164682165733255\"   \"Sinuosity: 0.239204956913075\"   \n[35] \"Sinuosity: 0.016108093806584\"    \"Sinuosity: 0.00906154759703019\" \n[37] \"Sinuosity: 0.000336031709654259\" \"Sinuosity: 0.00514258418589243\" \n[39] \"Sinuosity: 0.000358752556004398\" \"Sinuosity: 0.0117732143632709\"  \n[41] \"Sinuosity: 0.000941722231140817\" \"Sinuosity: 0.00204059110850892\" \n[43] \"Sinuosity: 0.0149188344679335\"   \"Sinuosity: 0.00808809762515778\" \n[45] \"Sinuosity: 0.000303074480727701\" \"Sinuosity: 0.00131581362895953\" \n[47] \"Sinuosity: 0.00139961881332193\"  \"Sinuosity: 0.0158215286846946\"  \n\n\n\n\nCompute Slope\n\nst_bbox(poudre_pts)  # Get bounding box of river points\n\n     xmin      ymin      xmax      ymax \n-823445.8 1966756.5 -722478.0 2008677.6 \n\nst_bbox(dem)         # Get bounding box of DEM\n\n   xmin    ymin    xmax    ymax \n-769695 1978485 -752535 2000235 \n\n\n\nstart_elevation &lt;- poudre_pts$elevation[1] \n\nend_elevation &lt;- poudre_pts$elevation[nrow(poudre_pts)]  \n\ndelta_elevation &lt;- end_elevation - start_elevation\nriver_length_m &lt;- river_length / 100 \n\nslope &lt;- delta_elevation / river_length_m\n\nprint(slope)\n\nNA [1/m]"
  }
]